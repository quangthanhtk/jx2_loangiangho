--ÐÞ¸´Ë¢ÈÙÓþ°ïÅÉ±¦Ïä²ú³öµÄ°×¾ÔÍè ÁùÉñÍè ÈýÇåÍè

t_Fix_201606 = {
	nTimeLine = 20160617,
	--tMap = {},
	t_Black_list = {
    --	{"account", "role"},
--        {"minisakano1", "oo0LinhMiu0oo"},
--        {"ngockutekute5", "iNMKzQueenBeezz"},
--        {"ngaxinh20109x", "ThoBuffZziiiBh"},
--        {"loveyoumylove619", "oIoDevillDeath"},
--        {"huynhminhthuan2015", "oBackleBo"},
--        {"hoangut2", "iiovzZZombie"},
--        {"duybv1979", "TAHzHaNoiBuon"},
--        {"khanhhoi187", "iozNhoVeEmHT3"},
--        {"mrminhnguyen1210", "oStTieuTuDaTinh0"},
--        {"hoaphuong58", "ThoXinhziiioZ"},
--        {"minhnguyen121083", "Ki?mMaT1T¨¨n2010"},
--        {"ngudocdetulk", "MuaRoiLangTham"},
--        {"quakhuvaanh0001", "iozLeeLeeioz"},
--        {"vcoinlk2012", "jxGhost"},
--        {"nhoccobac1989", "GreenyRose"},
--        {"mrminhnguyen007", "ostLinDaNguyenzx"},
--        {"nuanhhung1210", "ioZBuffThueffBH"},
--        {"servervanlong", "zTNzNhanTaiViet"},
--        {"0947781411", "LzLayVoNguoiTa"},
--        {"heotimheo2013", "IzLayChongNhoBan"},
--        {"tadocchuyendung", "iDocNayYHocBoTay"},
--        {"hanhanloveoxvn", "TAHzYangBee"},
--        {"huynhminhthuann2015", "02Backle02"},
--        {"nguyenthianhthu1995", "IzAudiR8zI"},
--        {"ngocvan123588", "aaaa12"},
--        {"lapsonlavippc", "UCHvItachi"},
--        {"lamnhathuy19942012", "TheKingPk"},
--        {"bomaylao006", "cuichuicuibap"},
--        {"thitxongkhoi1002", "zKungFuPanda"},
--        {"longhotranhhungbsdn1234", "NhutCaNa"},
--        {"tlq2901", "CuuAnThit"},
--        {"anhtrungkaka434", "zzzAnhTrungzzz"},
--        {"luongbenhdi05", "1TienHaSongDieu2"},
--        {"xusothantien261993", "SPzGauSieuNhanII"},
--        {"likapkthuphucyeuma", "CkChieuVkDuc"},
--        {"loveyoumylove2016", "oIoS?tTh?M¨®aQu1t"},
--        {"nhokyumi95", "zS2zKhanhLinho0o"},
--        {"duynht", "iZLamborghiniZi"},
--        {"nguyenthianhmi1986", "zS2AnhNg0k"},
--        {"anh_hung2030", "iiizNoBiTaz"},
--        {"xadixidaradi2109", "DuLongKh?ch"},
--        {"loveover1002", "iiiSiauM¨®aC¨¦t"},
--        {"tranduytanbkv", "phongthanhduong"},
--        {"ngamidanpro91", "iIRvS2GcIi"},
--        {"bictim", "haviet05"},
--        {"nguyenthanhtu62", "PhiMonAnh"},
--        {"doremonbame", "VanTieuDoatMenh"},
--        {"bunpoquakhu", "S2V¨°Kh¨®cS2"},
--        {"haosacdaisutxbt1", "T31110T3"},
--        {"wakeup229", "ALiSuSu"},
--        {"iloveyouxxxyyy", "oTheSilent0fLove"},
--        {"lamtieuphuong199882", "s2MrKeniiAmSoHot"},
--        {"caothanhthuy1990kg", "accposttl2"},
--        {"hohuynhhieu221267", "DGCCodon"},
--        {"ngamy19892016", "MinionNgaMy"},
--        {"volam112233166", "zzFBxGoodCity"},
--        {"nguyenhuunguyen6898", "ZT3ZzTi¨®uSiauChu"},
--        {"volamquan0030", "Ngh¨¬oV¡ÁGame"},
--        {"thoreal97", "ThoReal"},
--        {"dandutday1607", "HoangLamQuanchua"},
--        {"doideoyeu113", "st0oKimHaNao0"},
--        {"tuyetvahoa", "iiBichPhuong"},
--        {"mayantaodi_1", "vinh01"},
--        {"marcjac0bs1991", "JAVzThichToaSang"},
--        {"nghiavanduy", "zJameMoss"},
--        {"anhchangkho3999", "zTAEzNoBiTaS2"},
--        {"bunkorea90", "zNYzPinkSkyo0o"},
--        {"doncbvn2", "DKzTieuSieuChuoi"},
--        {"npcemhdacxtmlx", "izPeMap"},
--        {"canstopnt", "PexyPonggon"},
--        {"taisaozayem2012", "zzLHHzSauTatCa"},
--        {"designhb", "Jx2Trung1102"},
--        {"anahondass", "TaYUnha"},
--        {"truongvanbe1981", "iissBabyGirl1102"},
--        {"laysay987", "LoLzCh¨®Ti¨®uzLoL"},
--        {"tannernguyen2710", "zzDieuNhi"},
--        {"hoanghaitrung0804", "IPeNgheoKuT3"},
--        {"leminhtri2961996", "s2iiiSadMemories"},
--        {"whatalife000702", "iiZzLamTieuDiep"},
--        {"nguyenthikimquyen147", "malanhthien"},
--        {"nhaunhan", "SpoGoodSpeed"},
--        {"titanquest229", "ALiSuShi"},
--        {"nhatphienbangtam147", "nhatphienbangtam"},
--        {"ducoshirma", "JameNico215"},
--        {"volam2432371", "TenEmLagi"},
--        {"tunglatuoitho06", "0ooChangameoo0"},
--        {"duyprovt195", "MrNguy?nDuy"},
--        {"hieuhuyen3101", "oS2oKimThanLong"},
--        {"honghoatientu2007", "ThoTrangZiiizBH"},
--        {"duongmonnguyetung", "SakerFreedom01"},
--        {"nguyendinhphuctk3000", "PC2TongThiennKy"},
--        {"huhu339", "zKzBurberry"},
--        {"conlonnguyetung", "SakerFreedom1"},
--        {"gaoblue01", "NMKxFiora"},
--        {"boyzjn9x9x9x", "oIKh?ngKhaiIo"},
--        {"toanphuong023", "PHzMaiYeu"},
--        {"duytuan0935569355", "0oBanChanViet0o"},
--        {"khocchoniemdau", "BHzXvipXz"},
--        {"lordofthekjng1", "zLordOfTheKings"},
--        {"lamkg1980", "BuBuMapZiiizBH"},
--        {"duongprons555", "NsFxduongkillerx"},
--        {"mayantaodi_11", "o0ongud0co0o"},
--        {"nguyenhuunguyen6890", "T3zYeuSinhLyoo"},
--        {"nguyenhuyenanh34", "iiizXuKaz"},
--        {"toandieuls5", "S?i¡ì?n¡ì¨¦c"},
--        {"letrung191993", "Ng¦ÌnKu¡ì?mM¨¢iM?t"},
--        {"duongmonnguyetung1", "SakerFreedom001"},
--        {"hoanghaitrungw", "S2zzThatTinhBuon"},
--        {"nguyendinhphuctk2000", "Pc2DongYiYiYi"},
--        {"nguyendinhphuctk1000", "Pc2TongThienGiag"},
--        {"trungquan0026", "SoLoBacTrungNam"},
--        {"thienhadenhat12345pt", "ZzthienlanzZZ"},
--        {"vittappk", "izVitNhi"},
--        {"volam112233165", "JxHQ1Moons"},
--        {"hangho1995", "zzNHPzSauTatCa"},
--        {"lekietlevan", "SrTieuLongNhi"},
--        {"tklenh01", "ioizZzKieuNhi"},
--        {"ngamydan19892016", "MinionLaEm"},
--        {"superman01091992", "xxHaiLamTuongVi"},
--        {"hoangdo007", "GCzChiPheo"},
--        {"huungoc1970km", "Jx2SatThuKiem"},
--        {"gara0t0nguyen", "zIztieuthuyetty"},
--        {"hungpronmd", "iZzBHoziLanNhi"},
--        {"toandieuls91", "C?mX¨®cD?ngTr¦Ìo"},
--        {"lizziecarol", "zS2zHyugaHinata1"},
--        {"06huyen161195", "NgocOanhTeamNmk"},
--        {"denhieu2013", "zDNzEmXinCanTeam"},
--        {"huetrang11556", "ioizZzHueNhi"},
--        {"mayantaodi_1994", "cunbayby"},
--        {"zztinhtangzz", "¡ìaT¡ÁnhC?N-?ng"},
	},
}

function t_Fix_201606:fix_up(nLastLoginDate)
	if nLastLoginDate <= self.nTimeLine then
		local szAccount = GetAccount()
		local szRole = GetName()
		if self:is_in_black_list(szAccount, szRole)==1 then
    		local szLog = format("t_Fix_201606:fix_up [%s|%s LastLogin=%d] baiju=%d|%d liushen=%d|%d sanqing=%d|%d exp=%d", szAccount, szRole, nLastLoginDate
    			, BigGetItemCount(2,1,270), GetTask(2501)
    			, BigGetItemCount(2,1,1064), EatLiushen(1,0)
    			, BigGetItemCount(2,1,1097), EatSanqin(1,0)
    			, GetExp()
    		)
    		WriteLog(szLog)
    		--clear_item(2,1,270)--°×¾ÔÍè
    		--clear_item(2,1,1064)--ÁùÉñÍè
    		--clear_item(2,1,1097)--ÈýÇåÍè
    		SetTask(2501, 0)--°×¾ÔÍèÊ±¼ä
    		for i=1,2 do
    			local n = EatLiushen(1, -2000000000)--ÁùÉñÍèÊ±¼ä
    			if 0==n then break end
    		end
    		for i=1,2 do
    			local n = EatSanqin(1, -2000000000)--ÈýÇåÍèÊ±¼ä
    			if 0==n then break end
    		end
    		for i=1,100 do
    			local n = GetExp()
    			local nDel = -2000000000
    			if n < 2000000000 then
    				nDel = -1 * n
    			end
    			ModifyExp(nDel)
    			n = GetExp()
    			if n <= 0 then break end
    		end
    		local szMsg = format("§¹i hiÖp do sö dông ph­¬ng thøc kh«ng tÝch ®¸ng ®Ó nhËn phÇn th­ëng Vinh Danh B©ng Héi, thêi gian B¹ch CÇu, thêi gian Lôc ThÇn, thêi gian Tan Thanh vµ ®iÓm kinh nghiÖm cña ®¹i hiÖp ®· bÞ thiÕt lËp l¹i. NÕu cã ý kiÕn hoÆc vÊn ®Ò kh¸c mêi ®¹i hiÖp liªn l¹c víi hç trî game.")
    		Msg2Player(szMsg)
    		Talk(1,"",szMsg)
    	end
	end
end
function t_Fix_201606:is_in_black_list(szAccount, szRole)
	for i,v in self.t_Black_list do
		if v[1]==szAccount and v[2]==szRole then
			return 1
		end
	end
	return 0
end

function clear_item(g,d,p)
	local nCnt = BigGetItemCount(g,d,p)
	if nCnt > 0 then
		BigDelItem(g,d,p,nCnt)
	end
end
