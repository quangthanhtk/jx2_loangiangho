--ÁÉ¹úÂ·ÏßÍ¼
Import("\\script\\lib\\define.lua")

tMapPosInfo = {
{5077,1694,3221},
{5077,1681,3194},
{5077,1639,3183},
{5077,1610,3228},
{5077,1592,3245},
{5077,1610,3264},
{5077,1634,3249},
{5077,1662,3267},
{5077,1704,3244},
{5077,1700,3207},
{5077,1680,3183},
{5077,1682,3216},
{5077,1684,3262},
{5077,1694,3287},
{5077,1696,3316},
{5077,1700,3340},
{5077,1680,3331},
{5077,1660,3328},
{5077,1708,3339},
{5077,1733,3314},
{5077,1727,3391},
{5077,1710,3293},
{5077,1705,3314},
{5077,1701,3333},
{5077,1701,3346},
{5077,1732,3370},
{5077,1723,3378},
{5077,1743,3395},
{5077,1727,3385},
{5077,1706,3367},
{5077,1736,3349},
{5077,1733,3387},
{5077,1743,3359},
{5077,1748,3380},
{5077,1742,3394},
{5077,1745,3407},
{5077,1737,3420},
{5077,1727,3391},
{5077,1744,3422},
{5077,1732,3424},
{5077,1726,3436},
{5077,1719,3434},
{5077,1713,3446},
{5077,1727,3453},
{5077,1737,3453},
{5077,1733,3471},
{5077,1724,3471},
{5077,1707,3463},
{5077,1707,3446},
{5077,1761,3431},
{5077,1767,3420},
{5077,1775,3414},
{5077,1763,3398},
{5077,1761,3390},
{5077,1773,3378},
{5077,1775,3357},
{5077,1783,3358},
{5077,1792,3373},
{5077,1792,3395},
{5077,1804,3401},
{5077,1793,3417},
{5077,1813,3421},
{5077,1822,3405},
{5077,1826,3485},
{5077,1823,3362},
{5077,1815,3344},
{5077,1795,3354},
{5077,1778,3359},
{5077,1818,3335},
{5077,1809,3357},
{5077,1779,3302},
{5077,1793,3309},
{5077,1805,3312},
{5077,1800,3290},
{5077,1811,3299},
{5077,1810,3277},
{5077,1824,3286},
{5077,1831,3298},
{5077,1837,3319},
{5077,1850,3316},
{5077,1860,3302},
{5077,1851,3284},
{5077,1862,3280},
{5077,1884,3291},
{5077,1896,3285},
{5077,1865,3273},
{5077,1852,3262},
{5077,1882,3318},
{5077,1840,3294},
{5077,1808,3243},
{5077,1799,3210},
{5077,1776,3214},
{5077,1773,3241},
{5077,1793,3238},
{5077,1795,3259},
{5077,1764,3274},
{5077,1739,3257},
{5077,1735,3245},
{5077,1759,3287},
{5077,1776,3265},
{5077,1789,3236},
{5077,1812,3258},
{5077,1733,3205},
{5077,1724,3183},
{5077,1679,3185},
{5077,1938,3295},
{5077,1939,3311},
{5077,1919,3320},
{5077,1935,3330},
{5077,1925,3353},
{5077,1916,3367},
{5077,1915,3333},
{5077,1890,3338},
{5077,1877,3345},
{5077,1858,3353},
{5077,1850,3391},
{5077,1861,3411},
{5077,1878,3398},
{5077,1891,3381},
{5077,1920,3362},
{5077,1901,3425},
{5077,1911,3412},
{5077,1903,3445},
{5077,1890,3476},
{5077,1864,3453},
{5077,1882,3449},
{5077,1893,3504},
{5077,1912,3507},
{5077,1922,3524},
{5077,1928,3548},
{5077,1909,3564},
{5077,1885,3555},
{5077,1886,3530},
{5077,1855,3536},
{5077,1841,3502},
{5077,1844,3476},
{5077,1818,3471},
{5077,1807,3500},
{5077,1783,3481},
{5077,1805,3519},
{5077,1804,3551},
{5077,1822,3564},
{5077,1848,3556},
{5077,1852,3590},
{5077,1832,3610},
{5077,1819,3598},
{5077,1804,3616},
{5077,1786,3620},
{5077,1774,3600},
{5077,1762,3612},
{5077,1770,3563},
{5077,1768,3532},
{5077,1792,3569},
{5077,1801,3591},
{5077,1747,3461},
{5077,1742,3488},
{5077,1746,3518},
{5077,1750,3549},
{5077,1720,3566},
{5077,1723,3545},
{5077,1728,3514},
{5077,1711,3514},
{5077,1697,3498},
{5077,1685,3490},
{5077,1821,3470},
{5077,1755,3456},
{5077,1710,3449},
{5077,1731,3453},
{5077,1758,3402},
{5077,1760,3317},
{5077,1792,3326},
{5077,1841,3365},
{5077,1829,3393},
{5077,1849,3445},
{5077,1862,3486},
{5077,1883,3524},
{5077,1805,3265},
{5077,1813,3307},
{5077,1749,3414},
{5077,1763,3429},
	}

function OnUse(nItemIdx)
	if GetTime() - GetTask(TASKID_SW_LIAOGUO_MAP_CD) >= 600 then   
		local	nRand = random(1,getn(tMapPosInfo));
		local nNpcIdx = CreateNpc("Tiªu Xa 5","Xe ngùa chøa cèng phÈm",tMapPosInfo[nRand][1],tMapPosInfo[nRand][2],tMapPosInfo[nRand][3]);
		SetNpcLifeTime(nNpcIdx,10*60);
		SetNpcScript(nNpcIdx,"\\script\\pop\\2012\\liaoguo_cike_npc.lua");
		nNpcIdx = CreateNpc("Cao Thñ Liªu Quèc","Cao Thñ Liªu Quèc",tMapPosInfo[nRand][1],tMapPosInfo[nRand][2] - 3,tMapPosInfo[nRand][3] - 1);
		ChangeNpcToFight(nNpcIdx,0,6);
		SetNpcLifeTime(nNpcIdx,10*60);
		SetNpcScript(nNpcIdx,"\\script\\pop\\2012\\liaoguo_gaoshou_npc.lua");
		SetTask(TASKID_SW_LIAOGUO_MAP_CD, GetTime());
		SetTask(TASKID_SW_ITEM_ZLSSW_MAP_IDX,nRand);
		Talk(1,"",format("Liªu Quèc Lé TuyÕn §å: Th«ng qua Liªu Quèc Lé TuyÕn §å, ng­¬i ®· hiÓu râ tuyÕn ®­êng vËn chuyÓn cèng phÈm cña Liªu Quèc, hiÖn t¹i hä ®ang ë V©n Trung %d,%d.",tMapPosInfo[nRand][2]/8,tMapPosInfo[nRand][3]/16));
	else
		local nMapRandIdx = GetTask(TASKID_SW_ITEM_ZLSSW_MAP_IDX);
		if nMapRandIdx <= getn(tMapPosInfo) and nMapRandIdx >= 1 then
			Talk(1,"",format("Liªu Quèc Lé TuyÕn §å: Th«ng qua Liªu Quèc Lé TuyÕn §å, ng­¬i ®· hiÓu râ tuyÕn ®­êng vËn chuyÓn cèng phÈm cña Liªu Quèc, hiÖn t¹i hä ®ang ë V©n Trung %d,%d.",tMapPosInfo[nMapRandIdx][2]/8,tMapPosInfo[nMapRandIdx][3]/16));
		end
	end 
end